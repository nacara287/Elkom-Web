@model And.ElkomMuhasebe.Core.Model.Entity.Admin.User

@{
    ViewBag.Title = "Kullanıcı Düzenle";
   
}

<div class="row">

    @Html.AntiForgeryToken()

    @Html.HiddenFor(model => model.ID)

    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    <div class="col-xl-6 col-lg-6">
        <!-- START card -->
        <div class="card">
            <div class="card-header ">
                <div class="card-title">
                    Alt Kullanıcı Bilgileri
                </div>
            </div>
            <div class="card-body">

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label>Kullanıcı Adı</label>
                            @Html.EditorFor(model => model.username, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.username, "", new { @class = "text-danger" })
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label>Kullanıcı Şifre</label>
                            @Html.EditorFor(model => model.password, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.password, "", new { @class = "text-danger" })

                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label>İsim</label>
                            @Html.EditorFor(model => model.name, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.name, "", new { @class = "text-danger" })
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label>Soyisim</label>
                            @Html.EditorFor(model => model.surname, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.surname, "", new { @class = "text-danger" })
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label>E-Posta</label>
                            @Html.EditorFor(model => model.mail, new { htmlAttributes = new { @class = "form-control form-control-sm", @placeholder = "...", @aria_label = "...", @aria_describedby = "button-addon2" } })
                            @Html.ValidationMessageFor(model => model.mail, "", new { @class = "text-danger" })
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label>Telefon</label>
                            @Html.EditorFor(model => model.telephone, new { htmlAttributes = new { @class = "form-control" } })
                            @Html.ValidationMessageFor(model => model.telephone, "", new { @class = "text-danger" })
                        </div>
                    </div>
                    <div class="col-sm-6">
                        @if (Model.IsActive)
                        {
                            <div class="form-check switch switch-lg success full-width right m-b-0">
                                <input type="checkbox" value="true" id="IsActive" name="IsActive" checked>
                                <label for="IsActive">Aktif</label>
                            </div>}
                        else
                        { <div class="form-check switch switch-lg success full-width right m-b-0">
                                <input type="checkbox" value="true" id="IsActive" name="IsActive">
                                <label for="IsActive">Aktif</label>
                            </div>

                        }
                    </div>
                </div>
            </div>
        </div>
        <!-- END card -->
    </div>

    <div class="col-xl-6 col-lg-6">
        <!-- START card -->
        <div class="card">
            <div class="card-header ">
                <div class="card-title">
                    Rol Tanımları
                </div>
            </div>
            <div class="card-body">
                <table id="haktablo" class="table">
                    <thead>
                        <tr>
                            <th>Haklar</th>
                            <th>Kullanma</th>
                      
                        </tr>
                        <tr>
                            <th>Hepsini Seç/Bırak</th>
                            <th><input id="hepsiniseckullan" onClick="toggle(this,'name1')" type="checkbox" />  </th>
                         

                        </tr>
                    </thead>
                    <tbody>
                        @if (string.IsNullOrEmpty(Model.kullanma))
                        {
                            <tr>
                                <td>Cariler</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Cari Hareketleri Ve Fişleri</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Stoklar</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Stok  Hareketleri Ve Fişleri</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Kasalar</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Kasa  Hareketleri Ve Fişleri</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>İrsaliyeler</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Faturalar</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>E-Faturalar</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Sipariş</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Üretim</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Çekler</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Senetler</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Bankalar</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Banka  Hareketleri Ve Fişleri</td>
                                <td><input type="checkbox" name="name1" />  </td>

                            </tr>
                            <tr>
                                <td>Personeller</td>
                                <td><input type="checkbox" name="name1" />  </td>


                            </tr>
                            <tr>
                                <td>Personel  Hareketleri Ve Fişleri</td>
                                <td><input type="checkbox" name="name1" />  </td>

                            </tr>
                        }
                        else
                        {
                            <tr>
                                <td>Cariler</td>
                                @if (Model.kullanma.Contains("Cariler"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }


                            </tr>
                            <tr>
                                <td>Cari Hareketleri Ve Fişleri</td>
                                @if (Model.kullanma.Contains("Cari Hareketleri Ve Fişleri"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }



                            </tr>
                            <tr>
                                <td>Stoklar</td>
                                @if (Model.kullanma.Contains("Stoklar"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }

                            </tr>
                            <tr>
                                <td>Stok  Hareketleri Ve Fişleri</td>
                                @if (Model.kullanma.Contains("Stok  Hareketleri Ve Fişleri"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }

                            </tr>
                            <tr>
                                <td>Kasalar</td>
                                @if (Model.kullanma.Contains("Kasalar"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }

                            </tr>
                            <tr>
                                <td>Kasa  Hareketleri Ve Fişleri</td>
                                @if (Model.kullanma.Contains("Kasa  Hareketleri Ve Fişleri"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }
                            </tr>
                            <tr>
                                <td>İrsaliyeler</td>
                                @if (Model.kullanma.Contains("İrsaliyeler"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }

                            </tr>
                            <tr>
                                <td>Faturalar</td>
                                @if (Model.kullanma.Contains("Faturalar"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }

                            </tr>
                            <tr>
                                <td>E-Faturalar</td>
                                @if (Model.kullanma.Contains("E-Faturalar"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }
                            </tr>
                            <tr>
                                <td>Sipariş</td>
                                @if (Model.kullanma.Contains("Sipariş"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }
                            </tr>
                            <tr>
                                <td>Üretim</td>
                                @if (Model.kullanma.Contains("Üretim"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }
                            </tr>
                            <tr>
                                <td>Çekler</td>
                                @if (Model.kullanma.Contains("Çekler"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }
                            </tr>
                            <tr>
                                <td>Senetler</td>
                                @if (Model.kullanma.Contains("Senetler"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }

                            </tr>
                            <tr>
                                <td>Bankalar</td>
                                @if (Model.kullanma.Contains("Bankalar"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }
                            </tr>
                            <tr>
                                <td>Banka  Hareketleri Ve Fişleri</td>
                                @if (Model.kullanma.Contains("Banka  Hareketleri Ve Fişleri"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }
                            </tr>
                            <tr>
                                <td>Personeller</td>
                                @if (Model.kullanma.Contains("Personeller"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }

                            </tr>
                            <tr>
                                <td>Personel  Hareketleri Ve Fişleri</td>
                                @if (Model.kullanma.Contains("Personel  Hareketleri Ve Fişleri"))
                                {
                                    <td><input type="checkbox" name="name1" checked />  </td>
                                }
                                else
                                {
                                    <td><input type="checkbox" name="name1" />  </td>

                                }
                            </tr>
}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="butonlar" class="fixed-bottom py-1 text-center">
        <button type="submit" onclick="arayaekle()" class="btn btn-sm btn-primary btn-icon-split">
            <span class="icon text-white-50">
                <i class="fas fa-save"></i>
            </span>
            <span class="text">Kaydet</span>

        </button>
        <a href="/AltUsers/Edit" class="btn btn-sm btn-secondary btn-icon-split">
            <span class="icon text-white-50">
                <i class="fas fa-power-off"></i>
            </span>
            <span class="text">İptal</span>
        </a>
    </div>
</div>



@section script{
    <script type="text/javascript">

        var kullan = [];


        function toggle(source, name) {
            checkboxes = document.getElementsByName(name);
            for (var i = 0, n = checkboxes.length; i < n; i++) {
                checkboxes[i].checked = source.checked;
            }
        }
        function arayaekle() {
            var user = { ID: @Model.ID , username: document.getElementById("username").value, password: document.getElementById("password").value, name: document.getElementById("name").value, surname: document.getElementById("surname").value, mail: document.getElementById("mail").value, telephone: document.getElementById("telephone").value, IsActive: document.getElementById("IsActive").value }
            var oTable = document.getElementById('haktablo');

            //gets rows of table
            var rowLength = oTable.rows.length;

            //loops through rows
            for (i = 2; i < rowLength; i++) {
                var oCells = oTable.rows.item(i).cells;
                var cellLength = oCells.length;

                for (var j = 0; j < cellLength; j++) {

                    // get your cell info here
                    if (j == 1) {
                        var cellVal = oCells.item(j).firstChild;
                        if (cellVal.checked == 1)
                            kullan.push(oCells.item(0).innerHTML);
                    }


                }
            }

            $.ajax({
                type: "POST",

                dataType: "json",
                contentType: "application/json; charset=utf-8",
                url: "/Admin/Users/Edit/",
                data: JSON.stringify({
                    altUser: user,
                    Kullan: kullan,

                }),
                success: function (result) {
                    window.location = "/Admin/Users/";

                },
                error: function (result) {
                    alert('error');
                }
            });
        }






    </script>


}


